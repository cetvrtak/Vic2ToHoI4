sphere_decisions = {

	add_to_sphere = {
		target_trigger = {
		}
		available = {
			ROOT = {
				custom_trigger_tooltip = { tooltip = most_influence_tt }
				hidden_trigger = {
					FROM = { check_variable = { var = inf_count_@ROOT value = 1 } }		#Disable when 0 influence
					all_other_country = {												#ROOT influenced them most often
						has_idea = great_power
						FROM = { NOT = { is_subject_of = PREV } }						#Excluding their master
						FROM = { check_variable = { inf_count_@PREV < inf_count_@ROOT } }
					}
				}
			}
			FROM = { has_government = ROOT }	#otherwise they would automatically switch to master's ideology

			#Free countries
			if = { limit = { FROM = { is_subject = no } }
				FROM = { custom_trigger_tooltip = { tooltip = add_to_sphere_free_tt }
					hidden_trigger = {
						check_variable = { var = tot_autonomy value = 200 }		#Autonomy points
					}
				}
			}

			#Spherelings
			if = { limit = { FROM = { NOT = { is_subject_of = ROOT } has_autonomy_state = autonomy_sphereling } }
				FROM = { custom_trigger_tooltip = { tooltip = add_to_sphere_spherelings_tt }
					hidden_trigger = {
						NOT = { compare_autonomy_progress_ratio < 1 }	#100% autonomy or more
					}
				}
			}
			NOT = { has_war_with = FROM }
		}
		visible = {
			FROM = { NOT = { is_subject_of = ROOT } }
			if = { limit = { FROM = { is_subject = no } }
				FROM = { check_variable = { var = tot_autonomy?0 value = 200 } }
			}
			else_if = { limit = { FROM = { has_autonomy_state = autonomy_sphereling } }
				FROM = { NOT = { compare_autonomy_progress_ratio < 1 } }
			}
		}
		cost = 0
		complete_effect = {
			set_autonomy = { target = FROM autonomy_state = autonomy_sphereling }
			FROM = { set_variable = { tot_autonomy = 0 } }
		}
		ai_will_do = {
			factor = 3
		}
	}

	decrease_autonomy = {
		target_trigger = {
		}
		available = {
			FROM = {
				custom_trigger_tooltip = { tooltip = autonomy_at_18_or_influenced_by_another_gp_tt }
				hidden_trigger = {
					OR = {
						compare_autonomy_progress_ratio > 0.18
						check_variable = { var = daily_autonomy_gain value = 0.3 }
					}
				}
			}
			NOT = { has_war_with = FROM }
		}
		visible = {
			FROM = {
				is_subject_of = ROOT
				has_autonomy_state = autonomy_sphereling
			}
		}
		cost = 25
		complete_effect = {
			FROM = { add_to_variable = { var = inf_count_@ROOT value = 1 } }
			FROM = {
				add_dynamic_modifier = {
					modifier = gp_influence_master
					scope = ROOT
					days = 180
				}
				subtract_from_variable = { var = daily_autonomy_gain value = 0.4 }
			}
		}
		days_remove = 180
		remove_effect = {
			FROM = {
				remove_dynamic_modifier = {
					modifier = gp_influence_master
					scope = ROOT
				}
				add_to_variable = { var = daily_autonomy_gain value = 0.4 }
			}
		}
		ai_will_do = {
			factor = 2
			modifier = {
				factor = 0.1
				FROM = { check_variable = { daily_autonomy_gain < 0.3 } }
			}
			modifier = {
				factor = 2
				FROM = { check_variable = { var = daily_autonomy_gain value = 0.6 } }
			}
		}
	}

	increase_autonomy = {
		target_trigger = {
		}
		available = {
			OR = {
				any_other_country = {
					has_idea = great_power
					FROM = { NOT = { is_subject_of = PREV } }
					FROM = { check_variable = { var = inf_count_@PREV value = inf_count_@ROOT } }
				}
				FROM = {
					if = {
						limit = { is_subject = no }
						custom_trigger_tooltip = { tooltip = increase_autonomy_tt }
						check_variable = { tot_autonomy < 200 }
					}
					else = { compare_autonomy_progress_ratio < 1 }
				}
				NOT = { has_war_with = FROM }
			}
		}
		visible = {
			OR = {
				any_other_country = {
					has_idea = great_power
					FROM = { NOT = { is_subject_of = PREV } }
					FROM = { check_variable = { var = inf_count_@PREV value = inf_count_@ROOT } }
				}
				FROM = {
					OR = {
						AND = {
							is_subject = no
							check_variable = { tot_autonomy < 200 }
						}
						AND = {
							NOT = { is_subject_of = ROOT }
							has_autonomy_state = autonomy_sphereling
							compare_autonomy_progress_ratio < 1
						}
					}
				}
			}
		}
		cost = 25
		complete_effect = {
			FROM = { add_to_variable = { var = inf_count_@ROOT value = 1 } }
			FROM = {
				add_dynamic_modifier = {
					modifier = gp_influence
					scope = ROOT
					days = 180
				}
				add_to_variable = { var = daily_autonomy_gain value = 0.3 }
			}
		}
		days_remove = 180
		remove_effect = {
			if = {
				limit = { FROM = { is_subject = no } }
				FROM = { add_to_variable = { var = tot_autonomy value = 36 } }
			}
			FROM = {
				remove_dynamic_modifier = {
					modifier = gp_influence
					scope = ROOT
				}
				subtract_from_variable = { var = daily_autonomy_gain value = 0.3 }
			}
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 10
				FROM = {
					NOT = { compare_autonomy_progress_ratio < 1 }
					all_other_country = {
						has_idea = great_power
						FROM = { NOT = { is_subject_of = PREV } }
						FROM = {
							check_variable = {
								var = inf_count_@PREV
								value = inf_count_@ROOT
								compare = less_than_or_equal
							}
						}
					}
					any_other_country = {
						has_idea = great_power
						FROM = { NOT = { is_subject_of = PREV } }
						FROM = { check_variable = { inf_count_@PREV = inf_count_@ROOT } }
					}
				}
			}
			modifier = {
				factor = 10
				FROM = {
					check_variable = { var = tot_autonomy value = 200 }
					all_other_country = {
						has_idea = great_power
						FROM = { NOT = { is_subject_of = PREV } }
						FROM = {
							check_variable = {
								var = inf_count_@PREV
								value = inf_count_@ROOT
								compare = less_than_or_equal
							}
						}
					}
					any_other_country = {
						has_idea = great_power
						FROM = { NOT = { is_subject_of = PREV } }
						FROM = { check_variable = { inf_count_@PREV = inf_count_@ROOT } }
					}
				}
			}
		}
	}
}